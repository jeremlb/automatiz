<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="/bower_components/jquery/dist/jquery.min.js"></script>
</head>
<body>
<form action="http://localhost:8000/api/cocktails/image" method="post" enctype="multipart/form-data">
    upload: <input type="file" id="test" name="cocktail_image[file]"/>
    <input type="submit"  value="envoyer"/>
</form>
<script>
    $(function () {

        $('#test').on('change', function(){
            console.log("TEST UPLOAD")
            // On récupère les élément du DOM
            var $this = $(this);

            // On récupère le fichier
            var file = $this[0].files[0];

            // On crée un FormData, c'est ce qu'on va envoyer au serveur
            var data = new FormData();
            data.append('cocktail_image[file]', file);

            // On envoie la requête AJAX
            $.ajax({
                type: 'POST',
                // On récupère l'url dans l'attribut data-target
                url: "http://localhost:8000/api/cocktails/image",
                // On passe le FormData en paramètre
                data: data,
                // On ne précise pas le contentType pour l'upload de fichier
                contentType: false,
                // Comme on passe directement un FormData on désactive le processData
                processData: false,
                success: function(response){
                    console.log("SUCCESS");
                },
                error: function(response, status) {
                    console.log("ERROR");
                    console.log(response.status);
                }
            });
        });
    });
</script>
</body>
</html>